<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css"/>
<link rel="stylesheet" media="screen and (min-height: 486px) and (max-height: 2000px)" type="text/css" href="zoomout-large.css"/>
<link rel="stylesheet" media="screen and (min-height: 100px) and (max-height: 485px)" type="text/css" href="zoomout-small.css"/>
<head>
<title>INCOMA v0.1 -sandbox-</title>
</head>
<body>
    <script src="jquery-1.9.1.js"></script>

<!-- HTML frame -->


    <div id="headerMain" style="color:#ccc;">
        <div id="headerName" class="header">
            INCOMA&nbsp;v0.1&nbsp;&ndash;&nbsp;sandbox&nbsp;&nbsp;&nbsp;
            <a id="headerUrl" href="http://incomaproject.org">
                incomaproject.org
            </a>
        </div>
        <div id="headerUserName" class="header">
            Nickname:&nbsp;
            <textarea id='namebox' spellcheck='false'></textarea>
        </div>
        <div id="headerChangeVis" class="header" >
            Visualisation:
            <select id="visChoice" name="visualisationChoice" size="1">
            </select>
        </div>
        <div id="headerImport" class="header">
            Import debate:&nbsp;
        </div>
        <div id="headerExport"  class="header">
            <a href="" id="headerExportLink" >&nbsp;</a>
        </div>
    </div>
    <div id="visualisationMain">
    </div>  

<!-- Javascript -->

<script>
    // var x = new makeX("X");
    // 
    // function makeX(s) {
    //     this.y = new makeY(s + "Y");
    // 
    //     function makeY(s) {
    //         this.z = s + "Z";
    //     }
    // }
    // 
    // alert ("x = " + JSON.stringify(x)); // shows 'x = {"y": {"z": "XYZ"} }'
</script>


<script src="d3.v3.min.js"></script>
<script src="opensave.js"></script>
<script src="modelc.js"></script>
<script src="visualisation.js"></script>
<script src="visualisation-zoomout.js"></script>

<script>
    Model.clear();
    
    var chooseVisualisation = $("#visChoice")[0];
    Visualisations.setOptions(chooseVisualisation, Visualisations.options());
    chooseVisualisation.onchange = function (e) {
        var i = chooseVisualisation.options[chooseVisualisation.selectedIndex].value;
        reInit(Visualisations.select(i));
    };
    
    reInit(Visualisations.select(0));
        
    function reInit(newVisualisation) {
        if (newVisualisation) {
            newVisualisation.init( $( "#visualisationMain" )[0], Model.model);
        }
    };
    
    var saveModelFile = function() { return Model.exportFile(); }

    var loadModelFile = function(file) {
                            var fileName = file.name || "current conversation" ;
                            blobToText( file, function(text) { Model.importFile(text); reInit(Visualisations.current()); } );
                        }; 

    addImportListener( $( "#headerImport" )[0], ".xml,.json,application/x-incoma", loadModelFile );
    addExportListener( $( "#headerExport" )[0], "Export!", "Incoma-conversation.json", saveModelFile );
</script>
</body>
</html>
