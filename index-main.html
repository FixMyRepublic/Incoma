<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css"/>
<link rel="stylesheet" type="text/css" href="zoomout.css"/>
<body>
    <script src="jquery-1.9.1.js"></script>

<!-- HTML frame -->


    <div id="headerMain">
        <div id="headerName">Incoma</div>
        <div id="headerImport">Import debate: </div>
        <div id="headerExport" ></div>
        <input type="button" id="buttonDump" name="dump" value="DUMP" onclick="alert(JSON.stringify(Model.model));" />
    </div>
    <div id="visualisationMain">
    </div>  

<!-- Javascript -->

<script>
    // var x = new makeX("X");
    // 
    // function makeX(s) {
    //     this.y = new makeY(s + "Y");
    // 
    //     function makeY(s) {
    //         this.z = s + "Z";
    //     }
    // }
    // 
    // alert ("x = " + JSON.stringify(x)); // shows 'x = {"y": {"z": "XYZ"} }'
</script>


<script src="opensave.js"></script>
<script src="modelb.js"></script>
<script src="visualisation.js"></script>
<script src="d3.v3.min.js"></script>
<script src="visualisation-zoomout.js"></script>

<script>
    var currentVisualisation = null;

    Model.clear();
    
    //FIXME: define mouseover and mouseout in visualisation-zoomout.js
    var NYI = function() {};
    var mouseover = NYI;
    var mouseout = NYI;
    var initNodeFilters = NYI;
    var initSizeFilters = NYI;
    
    reInit();
        
    function reInit() {
        if (currentVisualisation) {
            currentVisualisation.destroy();
        }
        else {
            currentVisualisation = Visualisations.visualisations[0];
        }
        currentVisualisation.init( $( "#visualisationMain" )[0], Model.model);    
    };
    
    var saveModelFile = function() { return Model.exportFile(); }

    var loadModelFile = function(file) {
                            var fileName = file.name || "current debate" ;
                            blobToText( file, function(text) { Model.importFile(text); reInit(); } );
                        }; 

    addImportListener( $( "#headerImport" )[0], ".xml,.json,application/x-incoma", loadModelFile );
    addExportListener( $( "#headerExport" )[0], "Export current debate", "Incoma-debate.json", saveModelFile );
</script>
</body>
</html>
